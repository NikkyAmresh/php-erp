{% extends "base.html" %} {% block title %}Teacher | Attendance{% endblock %} {%
block body %}

<h3>
  {{timeTable.branchCode}} - {{timeTable.semester}} sem section -
  {{timeTable.section|ucf}}
</h3>

<h4>
  Subject - {{timeTable.subjectName}}({{timeTable.subjectCode}}) -
  {{timeTable.day|ucf}}/{{timeTable.fromTime}}-{{timeTable.toTime}}
</h4>

<table>
  <thead>
    <tr>
      <th>Roll no.</th>
      <th>Student Name</th>
      <th>Status</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th>
        <button onclick="allP()" class="btn bg-gray-200 text-white bg-green-600">
          All Present</button
        ><button onclick="allA()" class="btn bg-gray-200 text-white bg-red-600">
          All Absent
        </button>
      </th>
    </tr>
  </thead>
  <tbody>
    {%for student in students%}
    <tr>
      <td>{{student.rollNum}}</td>
      <td>{{student.name}}</td>
      <td>
        <button onclick="addP(this)" data-studentID='{{student.id}}'
          class="pres btn bg-gray-200 text-black hover:text-white hover:bg-green-600"
        >
          Present</button
        ><button onclick="addA(this)" data-studentID='{{student.id}}'
          class="abs btn bg-gray-200 text-black hover:text-white hover:bg-red-600"
        >
          Absent
        </button>
        <button
          class="
            btn
            bg-gray-200
            text-black
            hover:text-white hover:bg-yellow-600
          "
        >
          Leave
        </button>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
<button onclick="submitAttendance()"  class="btn btn-primary">Submit</button>
<script>
  $(document).ready(function(){
    console.log('jQuery init');
  });


  function submitAttendance(){
    let formData = {present:[],absent:[]};
    $('.present').each(function () {
      formData.present.push($(this).attr('data-studentID'));
    })
    $('.absent').each(function () {
      formData.absent.push($(this).attr('data-studentID'));
    })
    console.log(formData);
  }
  function addP(e){
    $(e).addClass('text-white bg-green-600 present');
    $(e).siblings().each(function(){
      removeA(this);
    })
  }
  function addA(e){
    $(e).addClass('text-white bg-red-600 absent');
    $(e).siblings().each(function(){
      removeP(this);
    })
  }
  function removeP(e){
    $(e).removeClass('text-white bg-green-600 present');
  }
  function removeA(e){
    $(e).removeClass('text-white bg-red-600 absent');
  }

  function allP() {
    $('.pres').each(function () {
      addP(this);
    })
  }
  function allA() {
    $('.abs').each(function () {
      addA(this);
    })
  }
</script>
{% endblock %}
